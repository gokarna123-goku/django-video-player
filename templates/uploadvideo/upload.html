{% extends '../base.html'%}
{% load static %}

{%block titleblock%}Upload Video{%endblock%}
{%block bodyblock%}


<div class="w-full flex-1 py-3 px-4">
    <!-- If the video is uploaded then only allow to enter the video details in the form section -->
    <!-- Condition will be :- firstly upload vide after video upload completed, only the input form section will be visible and the user will enter the video details -->
    <div class="w-full min-h-[75ch] flex items-center justify-center">

           <!-- Copy tag -->
        <!-- <div id="videoContainer" class="flex items-center justify-center w-1/3 px-8">
            <label for="videoUploadInput" id="uploadLabel"
                class="flex flex-col items-center justify-center w-full min-h-52 py-10 px-8 border-2 border-dashed border-neutral-700/50 rounded-xl cursor-pointer bg-neutral-700/5 hover:bg-neutral-600/5 ease-in-out duration-500 mb-4">
                <div class="flex flex-col items-center justify-center text-center space-y-10">
                    <i id="uploadIcon" class="fa-solid fa-arrow-up-from-bracket text-5xl text-neutral-600"></i>
                    <div class="space-y-2.5">
                        <p id="uploadText" class="text-sm text-neutral-500 dark:text-neutral-400">
                            <span class="font-bold text-base"> Click to upload</span> <br>
                            or drag and drop your video
                        </p>
                    </div>
                </div>
                <input id="videoUploadInput" type="file" class="hidden" accept=".mp4" />
            </label>
            <video id="videoPreview" autoplay muted loop class="hidden aspect-video w-full rounded-md">
                <source id="videoSource" src="{{video_url}}" type="video/mp4">
            </video>
        </div> -->


        <!-- Input for uploading the video details -->
        <div class="w-full h-auto rounded-md py-10 px-16 grid grid-cols-3 gap-20 items-start relative">
            <div class="col-span-2 space-y-8 text-base text-neutral-600 font-medium">

                <!-- Video Upload section -->
                <div class="space-y-2.5">
                    <label for="image-upload" class="block">Upload Video</label>
                    <div id="videoContainer" class="flex items-center w-full">
                        <label for="videoUploadInput"
                            class="flex flex-col justify-center cursor-pointer w-full h-11 bg-neutral-950 px-4 rounded-md ring-1 ring-neutral-800">
                            <div class="w-full flex items-center gap-x-3">
                                <i id="uploadIcon" class="fa-solid fa-camera text-lg text-neutral-800"></i>
                                <p id="uploadText" class="text-neutral-700 font-medium">
                                    Click to upload video
                                </p>
                            </div>
                            <input id="videoUploadInput" type="file" class="hidden" accept=".mp4" />
                        </label>
                    </div>
                </div>

                <!-- Video title -->
                <div class="space-y-2.5">
                    <label for="video-title" class="block">
                        Video Title
                    </label>
                    <input type="text" id="video-title" placeholder="e.g. The best movie of the year"
                        class="w-full h-11 bg-neutral-950 outline-none px-4 placeholder-neutral-700 font-normal rounded-md ring-1 ring-neutral-800 focus:ring-red-500 text-neutral-200"
                        maxlength="50">
                    <!-- <small class="text-xs text-red-500 error font-normal" id="characterLimitError">
                        0/50
                    </small> -->
                </div>

                <!-- Video Description -->
                <div class="space-y-2.5">
                    <label for="video-desc" class="block">
                        Video Description
                    </label>
                    <textarea name="description" id="video-desc" cols="30" rows="4"
                        placeholder="e.g. This video provide the best video lists, and other information too..."
                        class="w-full h-auto bg-neutral-950 outline-none px-4 py-2 placeholder-neutral-700 font-normal rounded-md ring-1 ring-neutral-800 focus:ring-red-500 text-neutral-200"></textarea>
                </div>

                <div class="space-y-2.5">
                    <label for="image-upload" class="block">Upload Video Thumbnail</label>
                    <div class="w-full h-auto">
                        <label for="imageUploadInput"
                            class="flex flex-col items-center justify-center cursor-pointer w-full h-11 bg-neutral-950 px-4 rounded-md ring-1 ring-neutral-800">
                            <div class="w-full flex items-center gap-x-3">
                                <i class="fa-solid fa-camera text-lg text-neutral-800"></i>
                                <span class="text-neutral-700 font-medium">
                                    Upload Video Image
                                </span>
                            </div>
                            <input id="imageUploadInput" type="file" class="hidden" accept=".png, .jpg" />
                        </label>
                    </div>
                    <!-- Image preview -->
                    <img id="previewImage" src="#" alt="image preview"
                        class="hidden w-full aspect-video object-contain object-center p-1.5 rounded-md ring-1 ring-neutral-800">
                </div>

                <div class="w-full flex items-center">
                    <button
                        class="bg-red-500 text-neutral-950 font-medium text-base flex items-center justify-center px-5 py-2 rounded-md hover:bg-red-600 ease-in-out duration-300">
                        Upload Video Now
                    </button>
                </div>

            </div>

            <div class="col-span-1 sticky top-10 text-neutral-600 space-y-5">
                <div class="w-full aspect-video ring-1 ring-neutral-800 rounded-md p-1.5">
                    <video id="videoPreview" autoplay muted loop class="hidden aspect-video w-full rounded-md">
                        <source id="videoSource" src="{{video_url}}" type="video/mp4">
                    </video>
                </div>
                <!-- Image name -->
                <div class="w-full flex items-center gap-x-3 bg-neutral-900/50 px-8 py-2 rounded-md">
                    <i class="fa-solid fa-file-video text-base text-neutral-600"></i>
                    <span id="uploadLabel" class="text-base text-neutral-500 font-medium">
                        {{video_name}}
                    </span>
                </div>
            </div>

        </div>

    </div>
</div>

{%block scriptblock%}


<!-- JavaScript for Character Limit -->
<!-- <script>
    const videoTitleInput = document.getElementById('video-title');
    const characterLimitError = document.getElementById('characterLimitError');

    videoTitleInput.addEventListener('input', handleCharacterLimit);

    function handleCharacterLimit() {
        const inputValue = videoTitleInput.value;
        const maxLength = videoTitleInput.getAttribute('maxlength');

        if (inputValue.length > maxLength) {
            characterLimitError.textContent = `Maximum ${maxLength} characters`;
            characterLimitError.classList.remove('hidden');
        } else {
            characterLimitError.textContent = '';
            characterLimitError.classList.add('hidden');
        }
    }
</script> -->


<!-- JavaScript for Image Preview -->
<script>
    document.getElementById('imageUploadInput').addEventListener('change', handleImageSelect);

    function handleImageSelect(event) {
        const file = event.target.files[0];
        const reader = new FileReader();

        reader.onload = function (e) {
            const previewImage = document.getElementById('previewImage');
            previewImage.src = e.target.result;
            previewImage.classList.remove('hidden');
        }

        reader.readAsDataURL(file);
    }
</script>


<!-- Upload handle functions -->
<script>
    document.getElementById('videoUploadInput').addEventListener('change', handleFileSelect, false);
    document.getElementById('videoContainer').addEventListener('dragover', handleDragOver, false);
    document.getElementById('videoContainer').addEventListener('drop', handleFileDrop, false);

    function handleFileSelect(evt) {
        var file = evt.target.files[0];
        var videoContainer = document.getElementById('videoContainer');
        var uploadLabel = document.getElementById('uploadLabel');
        // var uploadIcon = document.getElementById('uploadIcon');
        // var uploadText = document.getElementById('uploadText');
        var videoPreview = document.getElementById('videoPreview');

        uploadLabel.textContent = file.name;
        uploadLabel.classList.add('text-neutral-500');
        uploadLabel.classList.add('min-h-auto');
        // uploadIcon.classList.add('hidden');
        // uploadText.classList.add('hidden');
        videoPreview.src = URL.createObjectURL(file);
        videoPreview.classList.remove('hidden');
        videoContainer.classList.add('flex-col');
    }

    function handleDragOver(evt) {
        evt.stopPropagation();
        evt.preventDefault();
        evt.dataTransfer.dropEffect = 'copy';
    }

    function handleFileDrop(evt) {
        evt.stopPropagation();
        evt.preventDefault();
        var file = evt.dataTransfer.files[0];
        document.getElementById('videoUploadInput').files = [file];
        document.getElementById('videoUploadInput').dispatchEvent(new Event('change'));
    }
</script>

{% endblock %}


{%endblock%}